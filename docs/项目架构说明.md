# SQLite3 数据库查看器 - 项目架构说明

## 项目定位
这是一个专为 MoonPalace 项目设计的 SQLite3 数据库可视化查看器，用于分析和监控 API 请求日志。

## 技术架构

### 后端架构
- **框架**: Flask 2.3.3 (轻量级Python Web框架)
- **数据库**: SQLite3 (嵌入式数据库)
- **数据处理**: Pandas 2.0.3 (数据分析和处理)
- **配置管理**: python-dotenv (环境变量管理)
- **日志系统**: Python logging (多级别日志记录)

### 前端架构
- **UI框架**: Bootstrap 5.3.0 (响应式设计)
- **图标系统**: Bootstrap Icons 1.10.0
- **交互**: Vanilla JavaScript (原生JS，无框架依赖)
- **通信**: AJAX (异步数据加载)

### 部署架构
```
用户浏览器 → Flask服务器 → SQLite数据库
     ↓              ↓            ↓
Bootstrap5+JS   Python+Pandas   moonpalace.sqlite
```

## 核心模块

### 1. 数据访问层 (app.py)
- **数据库连接**: `get_db_connection()` - 安全连接管理
- **表结构获取**: `get_tables()`, `get_table_schema()`
- **数据查询**: `get_table_data()` - 智能分页和排序
- **数据清理**: `clean_data_for_json()` - 处理NaN和特殊值

### 2. API接口层 (app.py)
- `/api/tables` - 获取所有表名
- `/api/table/<table_name>` - 获取表数据
- `/api/table/<table_name>/info` - 获取表信息
- `/api/database/info` - 获取数据库基本信息

### 3. 前端展示层 (index.html + app.js)
- **响应式布局**: 适配桌面和移动端
- **实时数据加载**: AJAX异步获取数据
- **智能格式化**: 自动识别数据类型并格式化显示
- **交互优化**: 点击行查看详情、一键刷新等

## 数据流
```
1. 用户访问首页 → 加载index.html
2. 页面初始化 → 调用/api/database/info获取数据库信息
3. 加载表列表 → 调用/api/tables获取所有表
4. 选择表 → 调用/api/table/<name>获取数据
5. 点击行 → 显示详细数据模态框
```

## 安全设计
- **SQL注入防护**: 使用参数化查询
- **输入验证**: 严格的表名和参数验证
- **错误处理**: 不暴露敏感系统信息
- **路径安全**: 防止目录遍历攻击